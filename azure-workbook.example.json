{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## ğŸ“Š ETF Agent - ì—°ê²°ëœ ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°ë§\n\n---\n\nì´ ëŒ€ì‹œë³´ë“œëŠ” ETF Agent ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì—°ê²°ëœ ëª¨ë“  ì„œë¹„ìŠ¤ì˜ ìƒíƒœë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ëª¨ë‹ˆí„°ë§í•©ë‹ˆë‹¤."
      },
      "name": "text - 0"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "1f74ed9a-e3ed-498d-8f88-122db7b479e1",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "ì‹œê°„ ë²”ìœ„",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 3600000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 300000
                },
                {
                  "durationMs": 900000
                },
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                }
              ],
              "allowCustom": true
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "parameters - 1"
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ“Š ì—°ê²°ëœ ì„œë¹„ìŠ¤ ëª©ë¡\n"
      },
      "name": "text - 2",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "union dependencies, requests\n| where timestamp {TimeRange}\n| extend ServiceName = coalesce(\n    tostring(customDimensions.['ai.cloud.role']),\n    tostring(cloud_RoleName),\n    iff(itemType == 'dependency', tostring(target), 'API Server')\n)\n| extend ServiceType = case(\n    tostring(type) contains 'Cosmos' or tostring(target) contains 'cosmos', 'ğŸ—„ï¸ Cosmos DB',\n    tostring(type) contains 'HTTP' or tostring(type) contains 'Ajax', 'ğŸŒ External API',\n    tostring(type) contains 'SQL', 'ğŸ’¾ SQL Database',\n    itemType == 'request', 'âš™ï¸ API Server',\n    strcat('ğŸ“¦ ', tostring(type))\n)\n| summarize \n    TotalCalls = count(),\n    SuccessRate = round(100.0 * countif(success == true) / count(), 2),\n    AvgDuration = round(avg(duration), 2),\n    P95Duration = round(percentile(duration, 95), 2),\n    MaxDuration = round(max(duration), 2),\n    FailedCalls = countif(success == false)\n    by ServiceName, ServiceType\n| extend Status = iff(SuccessRate >= 99, 'âœ… ì •ìƒ', iff(SuccessRate >= 95, 'âš ï¸ ì£¼ì˜', 'âŒ ì˜¤ë¥˜'))\n| project \n    Status,\n    ServiceType,\n    ServiceName,\n    TotalCalls,\n    ['ì„±ê³µë¥  (%)'] = SuccessRate,\n    ['í‰ê·  ì‘ë‹µì‹œê°„ (ms)'] = AvgDuration,\n    ['P95 ì‘ë‹µì‹œê°„ (ms)'] = P95Duration,\n    ['ìµœëŒ€ ì‘ë‹µì‹œê°„ (ms)'] = MaxDuration,\n    ['ì‹¤íŒ¨ ê±´ìˆ˜'] = FailedCalls\n| order by TotalCalls desc",
        "size": 0,
        "title": "ì„œë¹„ìŠ¤ë³„ í˜¸ì¶œ í†µê³„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "Status",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "icons",
                "thresholdsGrid": [
                  {
                    "operator": "contains",
                    "thresholdValue": "ì •ìƒ",
                    "representation": "success",
                    "text": ""
                  },
                  {
                    "operator": "contains",
                    "thresholdValue": "ì£¼ì˜",
                    "representation": "warning",
                    "text": ""
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "error",
                    "text": ""
                  }
                ]
              }
            },
            {
              "columnMatch": "ì„±ê³µë¥  (%)",
              "formatter": 8,
              "formatOptions": {
                "palette": "greenRed"
              }
            },
            {
              "columnMatch": "í‰ê·  ì‘ë‹µì‹œê°„ (ms)",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            }
          ]
        }
      },
      "name": "query - 3",
      "styleSettings": {
        "margin": "10px",
        "padding": "0px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ—„ï¸ Cosmos DB ìƒì„¸ ëª¨ë‹ˆí„°ë§\n"
      },
      "name": "text - 4",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "dependencies\n| where timestamp {TimeRange}\n| where tostring(type) contains 'Cosmos' or tostring(target) contains 'cosmos'\n| extend Operation = tostring(customDimensions.['db.operation'])\n| summarize \n    Calls = count(),\n    SuccessRate = round(100.0 * countif(success == true) / count(), 2),\n    AvgDuration = round(avg(duration), 2),\n    P95Duration = round(percentile(duration, 95), 2)\n    by Operation, target\n| extend OperationType = iff(isempty(Operation), 'Unknown', Operation)\n| project \n    ['Cosmos DB ì—”ë“œí¬ì¸íŠ¸'] = target,\n    ['ì‘ì—… ìœ í˜•'] = OperationType,\n    ['í˜¸ì¶œ ìˆ˜'] = Calls,\n    ['ì„±ê³µë¥  (%)'] = SuccessRate,\n    ['í‰ê·  ì‹œê°„ (ms)'] = AvgDuration,\n    ['P95 ì‹œê°„ (ms)'] = P95Duration\n| order by ['í˜¸ì¶œ ìˆ˜'] desc",
        "size": 0,
        "title": "Cosmos DB ì‘ì—…ë³„ í†µê³„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "query - 5",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "dependencies\n| where timestamp {TimeRange}\n| where tostring(type) contains 'Cosmos' or tostring(target) contains 'cosmos'\n| summarize \n    Calls = count(),\n    AvgDuration = avg(duration)\n    by bin(timestamp, 5m)\n| render timechart with (title=\"Cosmos DB í˜¸ì¶œ ì¶”ì´\", xtitle=\"ì‹œê°„\", ytitle=\"í˜¸ì¶œ ìˆ˜ / í‰ê·  ì‘ë‹µì‹œê°„(ms)\")",
        "size": 0,
        "title": "Cosmos DB ì‹œê°„ë³„ í˜¸ì¶œ ì¶”ì´",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "query - 6",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸŒ ì™¸ë¶€ API í˜¸ì¶œ ëª¨ë‹ˆí„°ë§\n"
      },
      "name": "text - 7",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "dependencies\n| where timestamp {TimeRange}\n| where tostring(type) contains 'HTTP' or tostring(type) contains 'Ajax'\n| extend ApiHost = tostring(split(tostring(target), '/')[0])\n| summarize \n    Calls = count(),\n    SuccessRate = round(100.0 * countif(success == true) / count(), 2),\n    AvgDuration = round(avg(duration), 2),\n    Failures = countif(success == false)\n    by ApiHost, type\n| project \n    ['API í˜¸ìŠ¤íŠ¸'] = ApiHost,\n    ['íƒ€ì…'] = type,\n    ['í˜¸ì¶œ ìˆ˜'] = Calls,\n    ['ì„±ê³µë¥  (%)'] = SuccessRate,\n    ['í‰ê·  ì‹œê°„ (ms)'] = AvgDuration,\n    ['ì‹¤íŒ¨ ìˆ˜'] = Failures\n| order by ['í˜¸ì¶œ ìˆ˜'] desc",
        "size": 0,
        "title": "ì™¸ë¶€ API í˜¸ì¶œ í†µê³„ (yfinance ë“±)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "query - 8",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## âš™ï¸ API ì—”ë“œí¬ì¸íŠ¸ ì„±ëŠ¥\n"
      },
      "name": "text - 9",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "requests\n| where timestamp {TimeRange}\n| extend Endpoint = strcat(tostring(customDimensions.['http.method']), ' ', tostring(url))\n| summarize \n    Calls = count(),\n    SuccessRate = round(100.0 * countif(success == true) / count(), 2),\n    AvgDuration = round(avg(duration), 2),\n    P95Duration = round(percentile(duration, 95), 2),\n    Failures = countif(success == false)\n    by name, resultCode\n| project \n    ['ì—”ë“œí¬ì¸íŠ¸'] = name,\n    ['ìƒíƒœ ì½”ë“œ'] = resultCode,\n    ['í˜¸ì¶œ ìˆ˜'] = Calls,\n    ['ì„±ê³µë¥  (%)'] = SuccessRate,\n    ['í‰ê·  ì‹œê°„ (ms)'] = AvgDuration,\n    ['P95 ì‹œê°„ (ms)'] = P95Duration,\n    ['ì‹¤íŒ¨ ìˆ˜'] = Failures\n| order by ['í˜¸ì¶œ ìˆ˜'] desc",
        "size": 0,
        "title": "API ì—”ë“œí¬ì¸íŠ¸ë³„ ì„±ëŠ¥",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "query - 10",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ“Š í˜ì´ì§€ ë·° Heatmap (ë‚ ì§œ/ì‹œê°„ë³„)\n"
      },
      "name": "text - pageview-heatmap",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| extend \n    Date = format_datetime(timestamp, 'yyyy-MM-dd'),\n    Hour = hourofday(timestamp)\n| summarize PageViewCount = count() by Date, Hour\n| order by Date asc, Hour asc",
        "size": 0,
        "title": "í˜ì´ì§€ ë·° Heatmap - ë‚ ì§œë³„/ì‹œê°„ëŒ€ë³„ í™œë™",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "table",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "PageViewCount",
              "formatter": 8,
              "formatOptions": {
                "min": 0,
                "palette": "blue"
              }
            }
          ],
          "hierarchySettings": {
            "treeType": 1,
            "groupBy": ["Date"],
            "expandTopLevel": true
          }
        }
      },
      "name": "query - pageview-heatmap-1",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| extend \n    DayOfWeek = case(\n        dayofweek(timestamp) == 0d, 'ì¼ìš”ì¼',\n        dayofweek(timestamp) == 1d, 'ì›”ìš”ì¼',\n        dayofweek(timestamp) == 2d, 'í™”ìš”ì¼',\n        dayofweek(timestamp) == 3d, 'ìˆ˜ìš”ì¼',\n        dayofweek(timestamp) == 4d, 'ëª©ìš”ì¼',\n        dayofweek(timestamp) == 5d, 'ê¸ˆìš”ì¼',\n        dayofweek(timestamp) == 6d, 'í† ìš”ì¼',\n        'Unknown'\n    ),\n    Hour = hourofday(timestamp)\n| summarize ViewCount = count() by DayOfWeek, Hour\n| extend DayOfWeekOrder = case(\n    DayOfWeek == 'ì›”ìš”ì¼', 1,\n    DayOfWeek == 'í™”ìš”ì¼', 2,\n    DayOfWeek == 'ìˆ˜ìš”ì¼', 3,\n    DayOfWeek == 'ëª©ìš”ì¼', 4,\n    DayOfWeek == 'ê¸ˆìš”ì¼', 5,\n    DayOfWeek == 'í† ìš”ì¼', 6,\n    DayOfWeek == 'ì¼ìš”ì¼', 7,\n    8\n)\n| order by DayOfWeekOrder asc, Hour asc\n| project DayOfWeek, Hour, ViewCount",
        "size": 0,
        "title": "ìš”ì¼ë³„/ì‹œê°„ëŒ€ë³„ í˜ì´ì§€ ë·° íŒ¨í„´",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "categoricalbar",
        "chartSettings": {
          "group": "DayOfWeek",
          "createOtherGroup": 0,
          "seriesLabelSettings": [
            {
              "seriesName": "ViewCount",
              "color": "blue"
            }
          ],
          "ySettings": {
            "numberFormatSettings": {
              "unit": 0,
              "options": {
                "style": "decimal",
                "useGrouping": true
              }
            }
          }
        }
      },
      "name": "query - pageview-heatmap-2",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| extend Hour = hourofday(timestamp)\n| summarize \n    TotalViews = count(),\n    UniquePages = dcount(name),\n    AvgDuration = avg(duration)\n    by Hour\n| extend HourLabel = strcat(Hour, ':00')\n| project \n    ['ì‹œê°„ëŒ€'] = HourLabel,\n    ['ì´ í˜ì´ì§€ë·°'] = TotalViews,\n    ['ê³ ìœ  í˜ì´ì§€ ìˆ˜'] = UniquePages,\n    ['í‰ê·  ì²´ë¥˜ì‹œê°„ (ms)'] = round(AvgDuration, 2)\n| order by ['ì‹œê°„ëŒ€'] asc",
        "size": 0,
        "title": "ì‹œê°„ëŒ€ë³„ í˜ì´ì§€ ë·° í†µê³„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ì´ í˜ì´ì§€ë·°",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            },
            {
              "columnMatch": "í‰ê·  ì²´ë¥˜ì‹œê°„ (ms)",
              "formatter": 8,
              "formatOptions": {
                "palette": "green"
              }
            }
          ]
        }
      },
      "name": "query - pageview-heatmap-3",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| extend PageName = name\n| extend Hour = hourofday(timestamp)\n| summarize ViewCount = count() by PageName, Hour\n| order by PageName asc, Hour asc",
        "size": 0,
        "title": "í˜ì´ì§€ë³„ ì‹œê°„ëŒ€ë³„ í™œë™ ë¶„í¬",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "barchart",
        "chartSettings": {
          "group": "PageName",
          "createOtherGroup": 0,
          "ySettings": {
            "numberFormatSettings": {
              "unit": 0,
              "options": {
                "style": "decimal",
                "useGrouping": true
              }
            }
          }
        }
      },
      "name": "query - pageview-heatmap-4",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ“ˆ ì‚¬ìš©ì ì°¸ì—¬ë„ (Engagement) ì§€í‘œ\n"
      },
      "name": "text - engagement",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let timeRange = {TimeRange};\nlet sessions = pageViews\n| where timestamp >= ago(timeRange)\n| extend SessionId = tostring(customDimensions.session_id)\n| where isnotempty(SessionId)\n| summarize \n    PageViewsPerSession = count(),\n    AvgDuration = avg(duration),\n    TotalDuration = sum(duration),\n    UniquePages = dcount(name),\n    FirstPage = min(name),\n    LastPage = max(name)\n    by SessionId\n| extend IsBouncedSession = iff(PageViewsPerSession == 1, 1, 0);\nlet totalSessions = toscalar(sessions | count);\nlet bouncedSessions = toscalar(sessions | where IsBouncedSession == 1 | count);\nsessions\n| summarize \n    ['ì´ ì„¸ì…˜ ìˆ˜'] = count(),\n    ['í‰ê·  ì„¸ì…˜ë‹¹ í˜ì´ì§€ë·°'] = round(avg(PageViewsPerSession), 2),\n    ['í‰ê·  ì„¸ì…˜ ì‹œê°„ (ì´ˆ)'] = round(avg(TotalDuration) / 1000, 2),\n    ['í‰ê·  í˜ì´ì§€ ì²´ë¥˜ì‹œê°„ (ì´ˆ)'] = round(avg(AvgDuration) / 1000, 2),\n    ['ë°˜ì†¡ë¥  (%)'] = round(100.0 * bouncedSessions / totalSessions, 2),\n    ['í‰ê·  ê³ ìœ  í˜ì´ì§€ ìˆ˜'] = round(avg(UniquePages), 2)",
        "size": 3,
        "title": "ì„¸ì…˜ ì°¸ì—¬ë„ ìš”ì•½",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "tiles",
        "tileSettings": {
          "showBorder": false,
          "titleContent": {
            "columnMatch": "ì´ ì„¸ì…˜ ìˆ˜",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "í‰ê·  ì„¸ì…˜ë‹¹ í˜ì´ì§€ë·°",
            "formatter": 12,
            "formatOptions": {
              "palette": "auto"
            },
            "numberFormat": {
              "unit": 17,
              "options": {
                "maximumSignificantDigits": 3,
                "maximumFractionDigits": 2
              }
            }
          }
        }
      },
      "name": "query - engagement-summary",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| extend UserId = tostring(customDimensions.user_id)\n| where isnotempty(UserId)\n| summarize \n    FirstVisit = min(timestamp),\n    LastVisit = max(timestamp),\n    TotalVisits = count(),\n    UniqueDays = dcount(format_datetime(timestamp, 'yyyy-MM-dd'))\n    by UserId\n| extend \n    IsReturningUser = iff(UniqueDays > 1, 1, 0),\n    DaysSinceFirstVisit = datetime_diff('day', now(), FirstVisit)\n| summarize \n    ['ì´ ì‚¬ìš©ì ìˆ˜'] = count(),\n    ['ì‹ ê·œ ì‚¬ìš©ì'] = countif(IsReturningUser == 0),\n    ['ì¬ë°©ë¬¸ ì‚¬ìš©ì'] = countif(IsReturningUser == 1),\n    ['ì¬ë°©ë¬¸ìœ¨ (%)'] = round(100.0 * countif(IsReturningUser == 1) / count(), 2),\n    ['í‰ê·  ë°©ë¬¸ ì¼ìˆ˜'] = round(avg(UniqueDays), 2)",
        "size": 0,
        "title": "ì‚¬ìš©ì ì¬ë°©ë¬¸ ë¶„ì„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "tiles",
        "tileSettings": {
          "showBorder": false
        }
      },
      "name": "query - engagement-retention",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| summarize \n    ViewCount = count(),\n    AvgDuration = avg(duration),\n    P50Duration = percentile(duration, 50),\n    P95Duration = percentile(duration, 95)\n    by PageName = name\n| project \n    ['í˜ì´ì§€'] = PageName,\n    ['ì¡°íšŒ ìˆ˜'] = ViewCount,\n    ['í‰ê·  ì²´ë¥˜ì‹œê°„ (ì´ˆ)'] = round(AvgDuration / 1000, 2),\n    ['ì¤‘ê°„ê°’ ì²´ë¥˜ì‹œê°„ (ì´ˆ)'] = round(P50Duration / 1000, 2),\n    ['P95 ì²´ë¥˜ì‹œê°„ (ì´ˆ)'] = round(P95Duration / 1000, 2)\n| order by ['ì¡°íšŒ ìˆ˜'] desc",
        "size": 0,
        "title": "í˜ì´ì§€ë³„ ì²´ë¥˜ì‹œê°„ ë¶„ì„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ì¡°íšŒ ìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            },
            {
              "columnMatch": "í‰ê·  ì²´ë¥˜ì‹œê°„ (ì´ˆ)",
              "formatter": 8,
              "formatOptions": {
                "palette": "green"
              }
            }
          ]
        }
      },
      "name": "query - engagement-page-time",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ¯ ìƒí˜¸ì‘ìš© (Interaction) ì§€í‘œ\n"
      },
      "name": "text - interaction",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| extend EventCategory = tostring(customDimensions.event_category)\n| summarize \n    EventCount = count(),\n    UniqueUsers = dcount(tostring(customDimensions.user_id)),\n    UniqueSessions = dcount(tostring(customDimensions.session_id))\n    by EventName = name, EventCategory\n| project \n    ['ì´ë²¤íŠ¸ ì¹´í…Œê³ ë¦¬'] = EventCategory,\n    ['ì´ë²¤íŠ¸ ì´ë¦„'] = EventName,\n    ['ë°œìƒ íšŸìˆ˜'] = EventCount,\n    ['ê³ ìœ  ì‚¬ìš©ì'] = UniqueUsers,\n    ['ê³ ìœ  ì„¸ì…˜'] = UniqueSessions,\n    ['ì„¸ì…˜ë‹¹ í‰ê·  ë°œìƒ'] = round(1.0 * EventCount / UniqueSessions, 2)\n| order by ['ë°œìƒ íšŸìˆ˜'] desc",
        "size": 0,
        "title": "ì‚¬ìš©ì ì´ë²¤íŠ¸ ë°œìƒ í†µê³„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ë°œìƒ íšŸìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            }
          ]
        }
      },
      "name": "query - interaction-events",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| extend SessionId = tostring(customDimensions.session_id)\n| where isnotempty(SessionId)\n| summarize InteractionCount = count() by SessionId\n| summarize \n    ['ì´ ì„¸ì…˜ ìˆ˜'] = count(),\n    ['í‰ê·  ì¸í„°ë™ì…˜ ìˆ˜'] = round(avg(InteractionCount), 2),\n    ['ì¤‘ê°„ê°’ ì¸í„°ë™ì…˜ ìˆ˜'] = percentile(InteractionCount, 50),\n    ['ìµœëŒ€ ì¸í„°ë™ì…˜ ìˆ˜'] = max(InteractionCount),\n    ['ë†’ì€ ì°¸ì—¬ ì„¸ì…˜ (10íšŒ ì´ìƒ)'] = countif(InteractionCount >= 10)\n| extend ['ë†’ì€ ì°¸ì—¬ ë¹„ìœ¨ (%)'] = round(100.0 * ['ë†’ì€ ì°¸ì—¬ ì„¸ì…˜ (10íšŒ ì´ìƒ)'] / ['ì´ ì„¸ì…˜ ìˆ˜'], 2)",
        "size": 0,
        "title": "ì„¸ì…˜ë‹¹ ìƒí˜¸ì‘ìš© ê¹Šì´",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "tiles",
        "tileSettings": {
          "showBorder": false
        }
      },
      "name": "query - interaction-depth",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ”§ ê¸°ëŠ¥ ì‚¬ìš©ë¥  (Feature Adoption)\n"
      },
      "name": "text - feature",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let totalUsers = toscalar(pageViews | where timestamp {TimeRange} | extend UserId = tostring(customDimensions.user_id) | where isnotempty(UserId) | summarize dcount(UserId));\nunion \n    (pageViews | where timestamp {TimeRange} | where name contains 'Chat' | extend Feature = 'ğŸ’¬ ì±„íŒ… ì¸í„°í˜ì´ìŠ¤'),\n    (pageViews | where timestamp {TimeRange} | where name contains 'ETF' and name contains 'Detail' | extend Feature = 'ğŸ“Š ETF ìƒì„¸ ì¡°íšŒ'),\n    (pageViews | where timestamp {TimeRange} | where name contains 'News' | extend Feature = 'ğŸ“° ë‰´ìŠ¤ í”¼ë“œ'),\n    (pageViews | where timestamp {TimeRange} | where name contains 'Dashboard' | extend Feature = 'ğŸ“ˆ ëŒ€ì‹œë³´ë“œ')\n| extend UserId = tostring(customDimensions.user_id)\n| where isnotempty(Feature)\n| summarize \n    ì‚¬ìš©íšŸìˆ˜ = count(),\n    ê³ ìœ ì‚¬ìš©ì = dcount(UserId),\n    í‰ê· ì²´ë¥˜ì‹œê°„_ì´ˆ = round(avg(duration) / 1000, 2)\n    by Feature\n| extend \n    ['ì‚¬ìš©ì ì±„íƒë¥  (%)'] = round(100.0 * ê³ ìœ ì‚¬ìš©ì / totalUsers, 2),\n    ['ì‚¬ìš©ìë‹¹ í‰ê·  ì‚¬ìš©'] = round(1.0 * ì‚¬ìš©íšŸìˆ˜ / ê³ ìœ ì‚¬ìš©ì, 2)\n| project \n    ['ê¸°ëŠ¥'] = Feature,\n    ['ì´ ì‚¬ìš© íšŸìˆ˜'] = ì‚¬ìš©íšŸìˆ˜,\n    ['ê³ ìœ  ì‚¬ìš©ì'] = ê³ ìœ ì‚¬ìš©ì,\n    ['ì‚¬ìš©ì ì±„íƒë¥  (%)'],\n    ['ì‚¬ìš©ìë‹¹ í‰ê·  ì‚¬ìš©'],\n    ['í‰ê·  ì²´ë¥˜ì‹œê°„ (ì´ˆ)'] = í‰ê· ì²´ë¥˜ì‹œê°„_ì´ˆ\n| order by ['ì´ ì‚¬ìš© íšŸìˆ˜'] desc",
        "size": 0,
        "title": "ì£¼ìš” ê¸°ëŠ¥ë³„ ì‚¬ìš©ë¥ ",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ì´ ì‚¬ìš© íšŸìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            },
            {
              "columnMatch": "ì‚¬ìš©ì ì±„íƒë¥  (%)",
              "formatter": 8,
              "formatOptions": {
                "palette": "green"
              }
            }
          ]
        }
      },
      "name": "query - feature-adoption",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name in ('search', 'filter_applied', 'sort_changed', 'chart_interaction')\n| extend EventType = case(\n    name == 'search', 'ğŸ” ê²€ìƒ‰',\n    name == 'filter_applied', 'ğŸ” í•„í„° ì ìš©',\n    name == 'sort_changed', 'â†•ï¸ ì •ë ¬ ë³€ê²½',\n    name == 'chart_interaction', 'ğŸ“Š ì°¨íŠ¸ í´ë¦­',\n    name\n)\n| summarize \n    ë°œìƒíšŸìˆ˜ = count(),\n    ê³ ìœ ì‚¬ìš©ì = dcount(tostring(customDimensions.user_id))\n    by EventType\n| extend ì‚¬ìš©ìë‹¹í‰ê·  = round(1.0 * ë°œìƒíšŸìˆ˜ / ê³ ìœ ì‚¬ìš©ì, 2)\n| project \n    ['ì¸í„°ë™ì…˜ ìœ í˜•'] = EventType,\n    ['ì´ ë°œìƒ íšŸìˆ˜'] = ë°œìƒíšŸìˆ˜,\n    ['ê³ ìœ  ì‚¬ìš©ì ìˆ˜'] = ê³ ìœ ì‚¬ìš©ì,\n    ['ì‚¬ìš©ìë‹¹ í‰ê· '] = ì‚¬ìš©ìë‹¹í‰ê· \n| order by ['ì´ ë°œìƒ íšŸìˆ˜'] desc",
        "size": 0,
        "title": "íƒìƒ‰ ë° ìƒí˜¸ì‘ìš© íŒ¨í„´",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ì´ ë°œìƒ íšŸìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "purple"
              }
            }
          ]
        }
      },
      "name": "query - feature-interaction",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## âš¡ í’ˆì§ˆ ì§€í‘œ (Quality Metrics)\n"
      },
      "name": "text - quality",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let totalRequests = toscalar(requests | where timestamp {TimeRange} | count);\nlet failedRequests = toscalar(requests | where timestamp {TimeRange} and success == false | count);\nlet totalPageViews = toscalar(pageViews | where timestamp {TimeRange} | count);\nrequests\n| where timestamp {TimeRange}\n| summarize \n    ['ì´ ìš”ì²­ ìˆ˜'] = count(),\n    ['í‰ê·  ì‘ë‹µì‹œê°„ (ms)'] = round(avg(duration), 2),\n    ['P50 ì‘ë‹µì‹œê°„ (ms)'] = round(percentile(duration, 50), 2),\n    ['P95 ì‘ë‹µì‹œê°„ (ms)'] = round(percentile(duration, 95), 2),\n    ['P99 ì‘ë‹µì‹œê°„ (ms)'] = round(percentile(duration, 99), 2),\n    ['ì—ëŸ¬ìœ¨ (%)'] = round(100.0 * failedRequests / totalRequests, 2)",
        "size": 0,
        "title": "API ì„±ëŠ¥ ë° ì—ëŸ¬ìœ¨",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "tiles",
        "tileSettings": {
          "showBorder": false
        }
      },
      "name": "query - quality-performance",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| extend LoadTime = duration\n| summarize \n    ì¡°íšŒìˆ˜ = count(),\n    í‰ê· ë¡œë”©ì‹œê°„ = round(avg(LoadTime), 2),\n    P50ë¡œë”©ì‹œê°„ = round(percentile(LoadTime, 50), 2),\n    P95ë¡œë”©ì‹œê°„ = round(percentile(LoadTime, 95), 2),\n    ëŠë¦°í˜ì´ì§€_3ì´ˆì´ìƒ = countif(LoadTime > 3000)\n    by PageName = name\n| extend ëŠë¦°í˜ì´ì§€ë¹„ìœ¨ = round(100.0 * ëŠë¦°í˜ì´ì§€_3ì´ˆì´ìƒ / ì¡°íšŒìˆ˜, 2)\n| project \n    ['í˜ì´ì§€'] = PageName,\n    ['ì¡°íšŒ ìˆ˜'] = ì¡°íšŒìˆ˜,\n    ['í‰ê·  ë¡œë”© (ms)'] = í‰ê· ë¡œë”©ì‹œê°„,\n    ['P50 ë¡œë”© (ms)'] = P50ë¡œë”©ì‹œê°„,\n    ['P95 ë¡œë”© (ms)'] = P95ë¡œë”©ì‹œê°„,\n    ['ëŠë¦° í˜ì´ì§€ ë¹„ìœ¨ (%)'] = ëŠë¦°í˜ì´ì§€ë¹„ìœ¨\n| order by ['ì¡°íšŒ ìˆ˜'] desc",
        "size": 0,
        "title": "í˜ì´ì§€ ë¡œë”© ì„±ëŠ¥ ë¶„ì„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "í‰ê·  ë¡œë”© (ms)",
              "formatter": 8,
              "formatOptions": {
                "palette": "greenRed"
              }
            },
            {
              "columnMatch": "ëŠë¦° í˜ì´ì§€ ë¹„ìœ¨ (%)",
              "formatter": 8,
              "formatOptions": {
                "palette": "redGreen"
              }
            }
          ]
        }
      },
      "name": "query - quality-loading",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "union exceptions, traces\n| where timestamp {TimeRange}\n| extend ErrorType = iff(itemType == 'exception', 'Exception', strcat('Trace-Level', tostring(severityLevel)))\n| extend UserId = tostring(customDimensions.user_id)\n| summarize \n    ì˜¤ë¥˜ë°œìƒìˆ˜ = count(),\n    ì˜í–¥ë°›ì€ì‚¬ìš©ì = dcount(UserId)\n    by ErrorType\n| extend ì‚¬ìš©ìë‹¹í‰ê· ì˜¤ë¥˜ = round(1.0 * ì˜¤ë¥˜ë°œìƒìˆ˜ / ì˜í–¥ë°›ì€ì‚¬ìš©ì, 2)\n| project \n    ['ì˜¤ë¥˜ íƒ€ì…'] = ErrorType,\n    ['ì´ ë°œìƒ ìˆ˜'] = ì˜¤ë¥˜ë°œìƒìˆ˜,\n    ['ì˜í–¥ë°›ì€ ì‚¬ìš©ì'] = ì˜í–¥ë°›ì€ì‚¬ìš©ì,\n    ['ì‚¬ìš©ìë‹¹ í‰ê·  ì˜¤ë¥˜'] = ì‚¬ìš©ìë‹¹í‰ê· ì˜¤ë¥˜\n| order by ['ì´ ë°œìƒ ìˆ˜'] desc",
        "size": 0,
        "title": "ì‚¬ìš©ì ê²½í—˜ ì˜¤ë¥˜ ì˜í–¥ ë¶„ì„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ì´ ë°œìƒ ìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "red"
              }
            }
          ]
        }
      },
      "name": "query - quality-errors",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ‘¥ ì½”í˜¸íŠ¸ ë¶„ì„ (Cohort Analysis)\n"
      },
      "name": "text - cohort",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let dailyUsers = pageViews\n| where timestamp >= ago(1d)\n| extend UserId = tostring(customDimensions.user_id)\n| where isnotempty(UserId)\n| summarize by UserId\n| count;\nlet weeklyUsers = pageViews\n| where timestamp >= ago(7d)\n| extend UserId = tostring(customDimensions.user_id)\n| where isnotempty(UserId)\n| summarize by UserId\n| count;\nlet monthlyUsers = pageViews\n| where timestamp >= ago(30d)\n| extend UserId = tostring(customDimensions.user_id)\n| where isnotempty(UserId)\n| summarize by UserId\n| count;\nprint \n    ['ì¼ì¼ í™œì„± ì‚¬ìš©ì (DAU)'] = dailyUsers,\n    ['ì£¼ê°„ í™œì„± ì‚¬ìš©ì (WAU)'] = weeklyUsers,\n    ['ì›”ê°„ í™œì„± ì‚¬ìš©ì (MAU)'] = monthlyUsers,\n    ['DAU/MAU ë¹„ìœ¨ (%)'] = round(100.0 * dailyUsers / monthlyUsers, 2),\n    ['WAU/MAU ë¹„ìœ¨ (%)'] = round(100.0 * weeklyUsers / monthlyUsers, 2)",
        "size": 0,
        "title": "í™œì„± ì‚¬ìš©ì ì§€í‘œ (DAU/WAU/MAU)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "tiles",
        "tileSettings": {
          "showBorder": false
        }
      },
      "name": "query - cohort-active-users",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| extend UserId = tostring(customDimensions.user_id)\n| where isnotempty(UserId)\n| summarize \n    FirstVisit = min(timestamp),\n    VisitCount = count(),\n    UniqueDays = dcount(format_datetime(timestamp, 'yyyy-MM-dd'))\n    by UserId\n| extend \n    UserType = case(\n        UniqueDays == 1, 'ğŸ†• ì‹ ê·œ ì‚¬ìš©ì',\n        UniqueDays <= 7, 'ğŸ”„ ì´ˆê¸° ì¬ë°©ë¬¸ì',\n        UniqueDays <= 30, 'â­ í™œì„± ì‚¬ìš©ì',\n        'ğŸ’ ì¶©ì„± ì‚¬ìš©ì'\n    ),\n    DaysSinceFirst = datetime_diff('day', now(), FirstVisit)\n| summarize \n    ì‚¬ìš©ììˆ˜ = count(),\n    í‰ê· ë°©ë¬¸ì¼ìˆ˜ = round(avg(UniqueDays), 2),\n    í‰ê· ë°©ë¬¸íšŸìˆ˜ = round(avg(VisitCount), 2)\n    by UserType\n| extend ì‚¬ìš©ìë¹„ìœ¨ = round(100.0 * ì‚¬ìš©ììˆ˜ / toscalar(summarize sum(ì‚¬ìš©ììˆ˜)), 2)\n| project \n    ['ì‚¬ìš©ì ìœ í˜•'] = UserType,\n    ['ì‚¬ìš©ì ìˆ˜'] = ì‚¬ìš©ììˆ˜,\n    ['ë¹„ìœ¨ (%)'] = ì‚¬ìš©ìë¹„ìœ¨,\n    ['í‰ê·  ë°©ë¬¸ ì¼ìˆ˜'] = í‰ê· ë°©ë¬¸ì¼ìˆ˜,\n    ['í‰ê·  ë°©ë¬¸ íšŸìˆ˜'] = í‰ê· ë°©ë¬¸íšŸìˆ˜\n| order by ì‚¬ìš©ììˆ˜ desc",
        "size": 0,
        "title": "ì‚¬ìš©ì ì„¸ê·¸ë¨¼íŠ¸ ë¶„ì„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "piechart"
      },
      "name": "query - cohort-segments",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let cohortPeriod = 7d;\nlet retentionPeriod = 7d;\nlet cohortUsers = pageViews\n| where timestamp between (ago(cohortPeriod + retentionPeriod) .. ago(retentionPeriod))\n| extend UserId = tostring(customDimensions.user_id)\n| where isnotempty(UserId)\n| summarize by UserId;\nlet returnedUsers = pageViews\n| where timestamp >= ago(retentionPeriod)\n| extend UserId = tostring(customDimensions.user_id)\n| where isnotempty(UserId)\n| summarize by UserId;\ncohortUsers\n| join kind=leftouter (returnedUsers) on UserId\n| summarize \n    ì´ˆê¸°ì‚¬ìš©ììˆ˜ = count(),\n    ì¬ë°©ë¬¸ì‚¬ìš©ììˆ˜ = countif(isnotempty(UserId1))\n| extend ìœ ì§€ìœ¨_7ì¼ = round(100.0 * ì¬ë°©ë¬¸ì‚¬ìš©ììˆ˜ / ì´ˆê¸°ì‚¬ìš©ììˆ˜, 2)\n| project \n    ['ì½”í˜¸íŠ¸ ê¸°ê°„'] = '7ì¼ ì „',\n    ['ì´ˆê¸° ì‚¬ìš©ì ìˆ˜'] = ì´ˆê¸°ì‚¬ìš©ììˆ˜,\n    ['7ì¼ í›„ ì¬ë°©ë¬¸ ì‚¬ìš©ì'] = ì¬ë°©ë¬¸ì‚¬ìš©ììˆ˜,\n    ['7ì¼ ìœ ì§€ìœ¨ (%)'] = ìœ ì§€ìœ¨_7ì¼",
        "size": 0,
        "title": "ì‚¬ìš©ì ìœ ì§€ìœ¨ (7ì¼ Retention)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "tiles",
        "tileSettings": {
          "showBorder": false
        }
      },
      "name": "query - cohort-retention",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ¯ ì „í™˜ í¼ë„ (Conversion Funnel)\n"
      },
      "name": "text - funnel",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let users = pageViews\n| where timestamp {TimeRange}\n| extend \n    UserId = tostring(customDimensions.user_id),\n    SessionId = tostring(customDimensions.session_id)\n| where isnotempty(SessionId);\nlet step1 = users | where name contains 'Dashboard' or name == '/' | summarize by SessionId;\nlet step2 = users | where name contains 'ETF' | summarize by SessionId;\nlet step3 = users | where name contains 'Detail' | summarize by SessionId;\nlet step4 = users | where name contains 'Chat' | summarize by SessionId;\nlet totalSessions = toscalar(step1 | count);\nunion \n    (step1 | extend Step = '1ï¸âƒ£ ëœë”© (Dashboard)', StepOrder = 1),\n    (step2 | extend Step = '2ï¸âƒ£ ETF ëª©ë¡ ì¡°íšŒ', StepOrder = 2),\n    (step3 | extend Step = '3ï¸âƒ£ ìƒì„¸ ì •ë³´ ì¡°íšŒ', StepOrder = 3),\n    (step4 | extend Step = '4ï¸âƒ£ AI ì±„íŒ… ì‚¬ìš©', StepOrder = 4)\n| summarize SessionCount = dcount(SessionId) by Step, StepOrder\n| order by StepOrder asc\n| extend \n    ['ì „í™˜ìœ¨ (%)'] = round(100.0 * SessionCount / totalSessions, 2),\n    ['ì´íƒˆë¥  (%)'] = round(100.0 - (100.0 * SessionCount / totalSessions), 2)\n| project \n    ['ë‹¨ê³„'] = Step,\n    ['ì„¸ì…˜ ìˆ˜'] = SessionCount,\n    ['ì „í™˜ìœ¨ (%)'],\n    ['ì´íƒˆë¥  (%)']",
        "size": 0,
        "title": "ì‚¬ìš©ì ì—¬ì • í¼ë„ ë¶„ì„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "barchart",
        "chartSettings": {
          "ySettings": {
            "numberFormatSettings": {
              "unit": 0,
              "options": {
                "style": "decimal",
                "useGrouping": true
              }
            }
          }
        }
      },
      "name": "query - funnel-journey",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "pageViews\n| where timestamp {TimeRange}\n| extend \n    SessionId = tostring(customDimensions.session_id),\n    PageName = name\n| where isnotempty(SessionId)\n| summarize Pages = make_list(PageName) by SessionId\n| extend \n    FirstPage = tostring(Pages[0]),\n    SecondPage = tostring(iff(array_length(Pages) > 1, Pages[1], '')),\n    ThirdPage = tostring(iff(array_length(Pages) > 2, Pages[2], '')),\n    PathLength = array_length(Pages)\n| where isnotempty(SecondPage)\n| summarize \n    ê²½ë¡œìˆ˜ = count(),\n    í‰ê· ê²½ë¡œê¸¸ì´ = round(avg(PathLength), 2)\n    by Journey = strcat(FirstPage, ' â†’ ', SecondPage, iff(isnotempty(ThirdPage), strcat(' â†’ ', ThirdPage), ''))\n| top 10 by ê²½ë¡œìˆ˜ desc\n| project \n    ['ì‚¬ìš©ì ì—¬ì •'] = Journey,\n    ['ë°œìƒ íšŸìˆ˜'] = ê²½ë¡œìˆ˜,\n    ['í‰ê·  í˜ì´ì§€ ìˆ˜'] = í‰ê· ê²½ë¡œê¸¸ì´",
        "size": 0,
        "title": "ì£¼ìš” ì‚¬ìš©ì ê²½ë¡œ (Top 10)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ë°œìƒ íšŸìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            }
          ]
        }
      },
      "name": "query - funnel-paths",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let goalEvents = dynamic(['search', 'filter_applied', 'etf_detail_view', 'chat_message_sent']);\ncustomEvents\n| where timestamp {TimeRange}\n| where name in (goalEvents)\n| extend \n    SessionId = tostring(customDimensions.session_id),\n    GoalType = case(\n        name == 'search', 'ğŸ” ê²€ìƒ‰ ìˆ˜í–‰',\n        name == 'filter_applied', 'ğŸ” í•„í„° ì‚¬ìš©',\n        name == 'etf_detail_view', 'ğŸ“Š ETF ìƒì„¸ ì¡°íšŒ',\n        name == 'chat_message_sent', 'ğŸ’¬ AI ì§ˆë¬¸',\n        name\n    )\n| summarize GoalAchieved = count() by SessionId, GoalType\n| summarize \n    ë‹¬ì„±ì„¸ì…˜ìˆ˜ = dcount(SessionId),\n    ì´ë‹¬ì„±íšŸìˆ˜ = sum(GoalAchieved)\n    by GoalType\n| extend ì„¸ì…˜ë‹¹í‰ê· ë‹¬ì„± = round(1.0 * ì´ë‹¬ì„±íšŸìˆ˜ / ë‹¬ì„±ì„¸ì…˜ìˆ˜, 2)\n| project \n    ['ëª©í‘œ ìœ í˜•'] = GoalType,\n    ['ë‹¬ì„± ì„¸ì…˜ ìˆ˜'] = ë‹¬ì„±ì„¸ì…˜ìˆ˜,\n    ['ì´ ë‹¬ì„± íšŸìˆ˜'] = ì´ë‹¬ì„±íšŸìˆ˜,\n    ['ì„¸ì…˜ë‹¹ í‰ê· '] = ì„¸ì…˜ë‹¹í‰ê· ë‹¬ì„±\n| order by ['ë‹¬ì„± ì„¸ì…˜ ìˆ˜'] desc",
        "size": 0,
        "title": "ëª©í‘œ ë‹¬ì„±ë¥  ë¶„ì„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ë‹¬ì„± ì„¸ì…˜ ìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "green"
              }
            }
          ]
        }
      },
      "name": "query - funnel-goals",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## ğŸ–±ï¸ ë§ˆìš°ìŠ¤ ìœ„ì¹˜ ë° ìƒí˜¸ì‘ìš© ë¶„ì„\n"
      },
      "name": "text - mouse-tracking",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == 'mouse_movement_summary'\n| extend page_name = tostring(customDimensions.page_name)\n| extend most_visited = tostring(customDimensions.most_visited_zone)\n| extend total_samples = toint(customDimensions.total_samples)\n| extend click_count = toint(customDimensions.click_count)\n| extend hover_count = toint(customDimensions.hover_count)\n| extend session_id = tostring(customDimensions.session_id)\n| summarize \n    Sessions = dcount(session_id),\n    AvgSamples = avg(total_samples),\n    TotalClicks = sum(click_count),\n    TotalHovers = sum(hover_count),\n    MostVisited = any(most_visited)\n    by page_name\n| project \n    ['í˜ì´ì§€'] = page_name,\n    ['ê°€ì¥ ë§ì´ ë°©ë¬¸í•œ ì˜ì—­'] = MostVisited,\n    ['ì„¸ì…˜ ìˆ˜'] = Sessions,\n    ['í‰ê·  ë§ˆìš°ìŠ¤ ìƒ˜í”Œ'] = round(AvgSamples, 1),\n    ['ì´ í´ë¦­ ìˆ˜'] = TotalClicks,\n    ['ì´ í˜¸ë²„ ìˆ˜'] = TotalHovers\n| order by Sessions desc",
        "size": 0,
        "title": "í˜ì´ì§€ë³„ ì„ í˜¸ ì˜ì—­ ìš”ì•½",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ì„¸ì…˜ ìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            },
            {
              "columnMatch": "ì´ í´ë¦­ ìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "green"
              }
            }
          ]
        }
      },
      "name": "query - mouse-summary",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == 'mouse_click'\n| extend page_name = tostring(customDimensions.page_name)\n| extend zone = tostring(customDimensions.zone)\n| where isnotempty(zone)\n| summarize \n    ClickCount = count(),\n    UniqueUsers = dcount(user_Id)\n    by page_name, zone\n| project \n    ['í˜ì´ì§€'] = page_name,\n    ['í™”ë©´ ì˜ì—­'] = zone,\n    ['í´ë¦­ ìˆ˜'] = ClickCount,\n    ['ê³ ìœ  ì‚¬ìš©ì'] = UniqueUsers\n| order by ClickCount desc",
        "size": 0,
        "title": "ì˜ì—­ë³„ í´ë¦­ ë¶„í¬ (íˆíŠ¸ë§µ ë°ì´í„°)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "table",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "í´ë¦­ ìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "min": 0,
                "palette": "greenRed"
              }
            }
          ]
        }
      },
      "name": "query - mouse-clicks-heatmap",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == 'mouse_click'\n| extend page_name = tostring(customDimensions.page_name)\n| extend rel_x = todouble(customDimensions.relative_x)\n| extend rel_y = todouble(customDimensions.relative_y)\n| where isnotnull(rel_x) and isnotnull(rel_y)\n| where rel_x >= 0 and rel_x <= 1 and rel_y >= 0 and rel_y <= 1\n| extend x_bucket = bin(rel_x, 0.1)\n| extend y_bucket = bin(rel_y, 0.1)\n| summarize ClickCount = count() by page_name, x_bucket, y_bucket\n| extend Xì˜ì—­ = strcat(tostring(toint(x_bucket * 100)), '%')\n| extend Yì˜ì—­ = strcat(tostring(toint(y_bucket * 100)), '%')\n| project \n    ['í˜ì´ì§€'] = page_name,\n    ['X ìœ„ì¹˜'] = Xì˜ì—­,\n    ['Y ìœ„ì¹˜'] = Yì˜ì—­,\n    ['í´ë¦­ ë°€ë„'] = ClickCount\n| order by ClickCount desc\n| take 50",
        "size": 0,
        "title": "í´ë¦­ ìœ„ì¹˜ íˆíŠ¸ë§µ (ìƒëŒ€ ì¢Œí‘œ 10% ë‹¨ìœ„)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "í´ë¦­ ë°€ë„",
              "formatter": 8,
              "formatOptions": {
                "min": 0,
                "palette": "turquoise"
              }
            }
          ]
        }
      },
      "name": "query - mouse-position-heatmap",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == 'mouse_hover'\n| extend page_name = tostring(customDimensions.page_name)\n| extend zone = tostring(customDimensions.zone)\n| extend hover_duration = toint(customDimensions.hover_duration_ms)\n| where isnotempty(zone)\n| summarize \n    HoverCount = count(),\n    AvgHoverTime = round(avg(hover_duration) / 1000.0, 2)\n    by page_name, zone\n| project \n    ['í˜ì´ì§€'] = page_name,\n    ['ì˜ì—­'] = zone,\n    ['í˜¸ë²„ íšŸìˆ˜'] = HoverCount,\n    ['í‰ê·  í˜¸ë²„ ì‹œê°„ (ì´ˆ)'] = AvgHoverTime\n| order by HoverCount desc",
        "size": 0,
        "title": "ì˜ì—­ë³„ í˜¸ë²„ íŒ¨í„´ (ê´€ì‹¬ ì˜ì—­ ë¶„ì„)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "í˜¸ë²„ íšŸìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "purple"
              }
            },
            {
              "columnMatch": "í‰ê·  í˜¸ë²„ ì‹œê°„ (ì´ˆ)",
              "formatter": 8,
              "formatOptions": {
                "palette": "orange"
              }
            }
          ]
        }
      },
      "name": "query - mouse-hover",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == 'mouse_click'\n| extend page_name = tostring(customDimensions.page_name)\n| extend element_str = tostring(customDimensions.element)\n| where isnotempty(element_str) and element_str != 'null'\n| extend element = parse_json(element_str)\n| extend ElementTag = tostring(element.tag)\n| extend ElementId = tostring(element.id)\n| extend ElementClass = tostring(element.className)\n| where isnotempty(ElementTag)\n| extend ElementInfo = case(\n        isnotempty(ElementId), strcat(ElementTag, '#', ElementId),\n        isnotempty(ElementClass), strcat(ElementTag, '.', substring(ElementClass, 0, 20)),\n        ElementTag\n    )\n| summarize \n    ClickCount = count(),\n    UniqueUsers = dcount(user_Id)\n    by page_name, ElementInfo\n| project \n    ['í˜ì´ì§€'] = page_name,\n    ['í´ë¦­ëœ ìš”ì†Œ'] = ElementInfo,\n    ['í´ë¦­ ìˆ˜'] = ClickCount,\n    ['ê³ ìœ  ì‚¬ìš©ì'] = UniqueUsers\n| order by ClickCount desc\n| take 20",
        "size": 0,
        "title": "ê°€ì¥ ë§ì´ í´ë¦­ëœ UI ìš”ì†Œ (Top 20)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "í´ë¦­ ìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "blue"
              }
            }
          ]
        }
      },
      "name": "query - mouse-elements",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == 'mouse_movement_summary'\n| extend page_name = tostring(customDimensions.page_name)\n| extend most_visited = tostring(customDimensions.most_visited_zone)\n| extend total_samples = toint(customDimensions.total_samples)\n| extend click_count = toint(customDimensions.click_count)\n| extend hover_count = toint(customDimensions.hover_count)\n| summarize \n    TotalSamples = sum(total_samples),\n    TotalClicks = sum(click_count),\n    TotalHovers = sum(hover_count),\n    MostVisited = any(most_visited)\n    by page_name\n| project \n    ['í˜ì´ì§€'] = page_name,\n    ['ê°€ì¥ ë§ì´ ë°©ë¬¸í•œ ì˜ì—­'] = MostVisited,\n    ['ì´ ìƒ˜í”Œ'] = TotalSamples,\n    ['ì´ í´ë¦­'] = TotalClicks,\n    ['ì´ í˜¸ë²„'] = TotalHovers\n| order by TotalSamples desc",
        "size": 0,
        "title": "í™”ë©´ ì˜ì—­ë³„ ë§ˆìš°ìŠ¤ í™œë™ ë¶„í¬ (3x3 ê·¸ë¦¬ë“œ)",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "barchart",
        "chartSettings": {
          "ySettings": {
            "numberFormatSettings": {
              "unit": 0,
              "options": {
                "style": "decimal",
                "useGrouping": true
              }
            }
          }
        }
      },
      "name": "query - mouse-zone-distribution",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name == 'scroll_position'\n| extend \n    page_name = tostring(customDimensions.page_name),\n    scroll_pct = toreal(customDimensions.scroll_percentage),\n    max_depth = toreal(customDimensions.max_scroll_depth)\n| summarize \n    AvgScrollDepth = round(avg(max_depth), 1),\n    MaxScrollDepth = round(max(max_depth), 1),\n    UniqueUsers = dcount(user_Id),\n    Reached100 = dcountif(user_Id, scroll_pct >= 99)\n    by page_name\n| extend \n    ['í˜ì´ì§€ í•˜ë‹¨ ë„ë‹¬ë¥  (%)'] = round(100.0 * Reached100 / UniqueUsers, 1)\n| project \n    ['í˜ì´ì§€'] = page_name,\n    ['í‰ê·  ìŠ¤í¬ë¡¤ ê¹Šì´ (%)'] = AvgScrollDepth,\n    ['ìµœëŒ€ ìŠ¤í¬ë¡¤ ê¹Šì´ (%)'] = MaxScrollDepth,\n    ['ê³ ìœ  ì‚¬ìš©ì'] = UniqueUsers,\n    ['í˜ì´ì§€ í•˜ë‹¨ ë„ë‹¬ë¥  (%)']\n| order by ['í‰ê·  ìŠ¤í¬ë¡¤ ê¹Šì´ (%)'] desc",
        "size": 0,
        "title": "í˜ì´ì§€ë³„ ìŠ¤í¬ë¡¤ ê¹Šì´ ë¶„ì„",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "í‰ê·  ìŠ¤í¬ë¡¤ ê¹Šì´ (%)",
              "formatter": 8,
              "formatOptions": {
                "min": 0,
                "max": 100,
                "palette": "blue"
              }
            },
            {
              "columnMatch": "í˜ì´ì§€ í•˜ë‹¨ ë„ë‹¬ë¥  (%)",
              "formatter": 8,
              "formatOptions": {
                "min": 0,
                "max": 100,
                "palette": "green"
              }
            }
          ]
        }
      },
      "name": "query - scroll-depth",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp {TimeRange}\n| where name in ('mouse_click', 'mouse_hover')\n| extend viewport_width = toint(customDimensions.viewport_width)\n| extend viewport_height = toint(customDimensions.viewport_height)\n| where isnotnull(viewport_width)\n| extend DeviceType = case(\n        viewport_width < 768, 'ğŸ“± Mobile',\n        viewport_width < 1024, 'ğŸ“± Tablet',\n        viewport_width < 1920, 'ğŸ’» Desktop',\n        'ğŸ–¥ï¸ Large Desktop'\n    )\n| extend Resolution = strcat(tostring(viewport_width), 'x', tostring(viewport_height))\n| summarize \n    InteractionCount = count(),\n    UniqueUsers = dcount(user_Id),\n    TopResolutions = make_set(Resolution, 5)\n    by DeviceType\n| project \n    ['ë””ë°”ì´ìŠ¤ íƒ€ì…'] = DeviceType,\n    ['ìƒí˜¸ì‘ìš© ìˆ˜'] = InteractionCount,\n    ['ê³ ìœ  ì‚¬ìš©ì'] = UniqueUsers,\n    ['ì£¼ìš” í•´ìƒë„'] = TopResolutions\n| order by InteractionCount desc",
        "size": 0,
        "title": "ë””ë°”ì´ìŠ¤ íƒ€ì…ë³„ ë§ˆìš°ìŠ¤ ìƒí˜¸ì‘ìš©",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "visualization": "piechart"
      },
      "name": "query - mouse-device-type",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 1,
      "content": {
        "json": "---\n## âŒ ì˜¤ë¥˜ ë° ì˜ˆì™¸\n"
      },
      "name": "text - 11",
      "customWidth": "100"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "union \n    (exceptions | extend itemKind = 'exception'),\n    (traces | where severityLevel >= 2 | extend itemKind = 'trace'),\n    (requests | where success == false | extend itemKind = 'failed_request'),\n    (dependencies | where success == false | extend itemKind = 'failed_dependency')\n| where timestamp {TimeRange}\n| extend \n    ErrorType = case(\n        itemKind == 'exception', strcat('âŒ Exception: ', tostring(type)),\n        itemKind == 'trace', strcat('âš ï¸ Trace (Level ', tostring(severityLevel), ')'),\n        itemKind == 'failed_request', strcat('ğŸ”´ Failed Request (', tostring(resultCode), ')'),\n        itemKind == 'failed_dependency', strcat('ğŸ”´ Failed Dependency: ', tostring(type)),\n        'Other'\n    ),\n    ErrorMessage = case(\n        itemKind == 'exception', tostring(outerMessage),\n        itemKind == 'trace', tostring(message),\n        itemKind == 'failed_request', strcat(tostring(name), ' - ', tostring(url)),\n        itemKind == 'failed_dependency', strcat(tostring(name), ' -> ', tostring(target)),\n        'Unknown'\n    )\n| summarize \n    Count = count(),\n    LatestOccurrence = max(timestamp),\n    FirstOccurrence = min(timestamp)\n    by ErrorType, ErrorMessage\n| project \n    ['ì˜¤ë¥˜ íƒ€ì…'] = ErrorType,\n    ['ë©”ì‹œì§€ ìš”ì•½'] = substring(ErrorMessage, 0, 80),\n    ['ë°œìƒ íšŸìˆ˜'] = Count,\n    ['ìµœê·¼ ë°œìƒ'] = LatestOccurrence,\n    ['ìµœì´ˆ ë°œìƒ'] = FirstOccurrence,\n    FullMessage = ErrorMessage\n| order by ['ë°œìƒ íšŸìˆ˜'] desc\n| take 20",
        "size": 0,
        "title": "ìµœê·¼ ì˜¤ë¥˜ ë° ì˜ˆì™¸ (Top 20) - í–‰ í´ë¦­í•˜ì—¬ ìƒì„¸ í™•ì¸",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ì˜¤ë¥˜ íƒ€ì…",
              "formatter": 1
            },
            {
              "columnMatch": "ë°œìƒ íšŸìˆ˜",
              "formatter": 8,
              "formatOptions": {
                "palette": "redBright"
              }
            },
            {
              "columnMatch": "FullMessage",
              "formatter": 5
            }
          ],
          "rowLimit": 20,
          "labelSettings": [
            {
              "columnId": "ë©”ì‹œì§€ ìš”ì•½",
              "label": "ë©”ì‹œì§€ (í´ë¦­í•˜ì—¬ ì „ì²´ ë³´ê¸°)"
            }
          ],
          "hierarchySettings": {
            "treeType": 1
          }
        },
        "sortBy": [],
        "exportFieldName": "ì˜¤ë¥˜ íƒ€ì…",
        "exportParameterName": "SelectedErrorType",
        "exportToExcelOptions": "visible",
        "showExportToExcel": true,
        "tileSettings": {
          "showBorder": false
        }
      },
      "name": "query - 12",
      "styleSettings": {
        "margin": "10px"
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "error-selection",
            "version": "KqlParameterItem/1.0",
            "name": "SelectedErrorType",
            "label": "ğŸ“Œ ì˜¤ë¥˜ ì„ íƒ (ìƒì„¸ ë¡œê·¸ í™•ì¸)",
            "type": 2,
            "query": "union \n    (exceptions | extend itemKind = 'exception'),\n    (traces | where severityLevel >= 2 | extend itemKind = 'trace'),\n    (requests | where success == false | extend itemKind = 'failed_request'),\n    (dependencies | where success == false | extend itemKind = 'failed_dependency')\n| where timestamp {TimeRange}\n| extend \n    ErrorType = case(\n        itemKind == 'exception', strcat('âŒ Exception: ', tostring(type)),\n        itemKind == 'trace', strcat('âš ï¸ Trace (Level ', tostring(severityLevel), ')'),\n        itemKind == 'failed_request', strcat('ğŸ”´ Failed Request (', tostring(resultCode), ')'),\n        itemKind == 'failed_dependency', strcat('ğŸ”´ Failed Dependency: ', tostring(type)),\n        'Other'\n    )\n| summarize Count = count() by ErrorType\n| order by Count desc\n| project value = ErrorType, label = strcat(ErrorType, ' (', Count, 'ê±´)')",
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.insights/components"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.insights/components"
      },
      "name": "parameters - 13"
    },
    {
      "type": 1,
      "content": {
        "json": "---\n### ğŸ“‹ ì„ íƒí•œ ì˜¤ë¥˜ì˜ ìƒì„¸ ë¡œê·¸ (ìµœê·¼ 10ê±´)\n"
      },
      "conditionalVisibility": {
        "parameterName": "SelectedErrorType",
        "comparison": "isNotEqualTo"
      },
      "name": "text - 14"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let selectedError = '{SelectedErrorType}';\nunion \n    (exceptions \n     | extend itemKind = 'exception',\n              ErrorType = strcat('âŒ Exception: ', tostring(type)),\n              ErrorMessage = tostring(outerMessage),\n              DetailJson = pack('Method', method, 'Assembly', assembly, 'OuterType', outerType, 'InnerMessage', innermostMessage)\n    ),\n    (traces \n     | where severityLevel >= 2\n     | extend itemKind = 'trace',\n              ErrorType = strcat('âš ï¸ Trace (Level ', tostring(severityLevel), ')'),\n              ErrorMessage = tostring(message),\n              DetailJson = pack('Severity', severityLevel, 'Level', case(severityLevel == 0, 'Verbose', severityLevel == 1, 'Info', severityLevel == 2, 'Warning', severityLevel == 3, 'Error', severityLevel == 4, 'Critical', 'Unknown'))\n    ),\n    (requests \n     | where success == false\n     | extend itemKind = 'failed_request',\n              ErrorType = strcat('ğŸ”´ Failed Request (', tostring(resultCode), ')'),\n              ErrorMessage = strcat(tostring(name), ' - ', tostring(url)),\n              DetailJson = pack('Method', customDimensions.['http.method'], 'URL', url, 'ResultCode', resultCode, 'Duration_ms', duration)\n    ),\n    (dependencies \n     | where success == false\n     | extend itemKind = 'failed_dependency',\n              ErrorType = strcat('ğŸ”´ Failed Dependency: ', tostring(type)),\n              ErrorMessage = strcat(tostring(name), ' -> ', tostring(target)),\n              DetailJson = pack('Type', type, 'Target', target, 'ResultCode', resultCode, 'Duration_ms', duration)\n    )\n| where timestamp {TimeRange}\n| where isnotempty(selectedError) and ErrorType == selectedError\n| project \n    ['ë°œìƒ ì‹œê°'] = format_datetime(timestamp, 'yyyy-MM-dd HH:mm:ss'),\n    ['ì˜¤ë¥˜ íƒ€ì…'] = ErrorType,\n    ['ì „ì²´ ë©”ì‹œì§€'] = ErrorMessage,\n    ['ìƒì„¸ ì •ë³´'] = DetailJson,\n    ['Operation ID'] = operation_Id\n| order by ['ë°œìƒ ì‹œê°'] desc\n| take 10",
        "size": 0,
        "title": "ì˜¤ë¥˜ ë°œìƒ ë‚´ì—­",
        "timeContext": {
          "durationMs": 0
        },
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "ì „ì²´ ë©”ì‹œì§€",
              "formatter": 1,
              "formatOptions": {
                "customColumnWidthSetting": "40%"
              }
            },
            {
              "columnMatch": "ìƒì„¸ ì •ë³´",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "CellDetails",
                "linkLabel": "ğŸ“„ ìƒì„¸ ë³´ê¸°"
              }
            },
            {
              "columnMatch": "Operation ID",
              "formatter": 5
            }
          ]
        }
      },
      "conditionalVisibility": {
        "parameterName": "SelectedErrorType",
        "comparison": "isNotEqualTo"
      },
      "name": "query - 15",
      "styleSettings": {
        "margin": "10px"
      }
    }
  ],
  "fallbackResourceIds": [
    "/subscriptions/YOUR_SUBSCRIPTION_ID/resourceGroups/YOUR_RESOURCE_GROUP/providers/microsoft.insights/components/YOUR_APP_INSIGHTS_NAME"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
